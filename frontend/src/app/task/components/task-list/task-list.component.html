<div class="controls-container">
  <mat-form-field appearance="outline" class="search-field">
    <mat-label>Pesquisar por título ou descrição</mat-label>
    <input matInput
           [ngModel]="searchTerm()"
           (ngModelChange)="searchTerm.set($event); searchChange.emit($event)"
           placeholder="Título ou Descrição"
           aria-label="Pesquisar Tarefas"
    />
    <mat-icon matSuffix>search</mat-icon>
  </mat-form-field>

  <mat-form-field appearance="outline" class="filter-field">
    <mat-label>Filtrar por Status</mat-label>
    <mat-select
      [ngModel]="filterStatus()"
      (ngModelChange)="filterStatus.set($event); filterChange.emit($event)"
      aria-label="Filtrar por Status"
    >
      <mat-option value="todos">Mostrar Todos</mat-option>
      <mat-option value="pendente">Pendente</mat-option>
      <mat-option value="em-andamento">Em Andamento</mat-option>
      <mat-option value="concluida">Concluída</mat-option>
    </mat-select>
  </mat-form-field>
</div>

<div class="task-list">
  @for (task of tasks; track task.id) {
    <app-task-card
      [task]="task"
      (edit)="editTask.emit($event)"
      (complete)="completeTask.emit($event)"
      (delete)="openDeleteModal($event)"
    />
  } @empty {
    <p class="no-tasks">Nenhuma tarefa encontrada. Que tal criar uma?</p>
  }
</div>

@if (isDeleteModalOpen()) {
  <div class="modal-backdrop">
    <div class="modal-content">
      <h3>Confirmação de Exclusão</h3>
      <p>Tem certeza que deseja excluir a tarefa: <strong>{{ taskToDelete()?.title }}</strong>?</p>
      <div class="modal-actions">
        <button class="delete-btn" (click)="confirmDelete()">Excluir</button>
        <button class="cancel-btn" (click)="closeDeleteModal()">Cancelar</button>
      </div>
    </div>
  </div>
}
